<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yalin Zhu" />

<meta name="date" content="2016-06-27" />

<title>Phase II single- or two-stage Multinomial Trial Design</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Phase II single- or two-stage Multinomial Trial Design</h1>
<h4 class="author"><em>Yalin Zhu</em></h4>
<h4 class="date"><em>2016-06-27</em></h4>



<div id="two-general-principles-of-hypothesis-testing" class="section level1">
<h1>Two general principles of hypothesis testing</h1>
<p>This section reviews some key principles that provide a foundation for multiple tests. It begins with two general principles, known as the principles of union-intersection testing (UIT) and intersection-union testing (IUT), that define the underlying testing problem.</p>
<div id="union-intersection-testing-uit" class="section level2">
<h2>Union-intersection testing (UIT)</h2>
<p>Within the union-intersection framework, one rejects the global hypothesis of no effect if there is evidence of a positive effect with respect to at least one individual objective. To provide a mathematical definition, let <span class="math inline">\(H_1,\dots,H_m\)</span> denote the hypotheses corresponding to the multiple objectives. The hypotheses are tested against the alternative hypotheses <span class="math inline">\(K_1,\dots,K_m\)</span>. The global null hypothesis <span class="math inline">\(H_{I}\)</span> , defined as the intersection of the hypotheses, is tested versus the union of the alternative hypotheses (<span class="math inline">\(K_{U}\)</span>): <span class="math display">\[H_{I}: \bigcap\limits_{i=1}^{m} H_i \quad versus \quad K_{U}: \bigcup\limits_{i=1}^{m} K_i. \]</span></p>
</div>
<div id="intersection-union-testing-iut" class="section level2">
<h2>Intersection-union testing (IUT)</h2>
<p>Intersection-union testing arises naturally in studies when a significant outcome with respect to two or more objectives is required in order to declare the study successful. For example, new drugs/therapies for the treatment of <em>Skin Cancer</em> are required to demonstrate their effects on both superiority (eg: partial response) and futility (eg: early progression). In other words, the intersection-union method involves testing the union of the hypotheses (<span class="math inline">\(H_U\)</span>) against the intersection of the alternative hypotheses (<span class="math inline">\(K_I\)</span>): <span class="math display">\[H_{U}: \bigcup\limits_{i=1}^{m} H_i \quad versus \quad K_{I}: \bigcap\limits_{i=1}^{m} K_i. \]</span></p>
<p>We differentiate between objective response and early progression. Let <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> be the probabilities of response and early disease progression, respectively. Note that <span class="math inline">\(p_1+p_2 \le 1\)</span>. Then the number of objective follow the trinomial distribution <span class="math inline">\(Tri(p_1,p_2,1-(p_1+p_2))\)</span>. For most phase II window studies, there is interest in proceeding with further evaluation of the agent if the response rate is sufficiently high and the early progression rate is sufficiently low. Thus, the study is designed to test <span class="math display">\[H_{U}: p_1 \le p_{01} \ or \ p_2 \le p_{02}  \quad versus \quad K_{I}: p_1 \ge p_{11} \ and \ p_2 \ge p_{12}, \]</span> which belongs to IUT.</p>
<p>For an one-stage design, let <span class="math inline">\(N\)</span> denote a fixed sample size, <span class="math inline">\(S\)</span> denote the number of partial response and <span class="math inline">\(T\)</span> denote the number of early progressions. Then the rejection region of the null hypothesis <span class="math inline">\(H_{U}\)</span> can be denoted by <span class="math display">\[ S \ge s \quad and \quad T \le t,\]</span> where <span class="math inline">\(s+t \le N\)</span>. The acceptance region of the null can be denoted by <span class="math display">\[ S &lt; s' \quad or \quad T &gt; t'.\]</span></p>
<p>For a two-stage design, let <span class="math inline">\(N_1\)</span> denote a fixed sample size at the first stage, <span class="math inline">\(S\)</span> denote the number of partial response and <span class="math inline">\(T\)</span> denote the number of early progressions. Then at the first stage, the rejection region of the null hypothesis <span class="math inline">\(H_{U}\)</span> can be denoted by <span class="math display">\[ S \ge s_1 \quad and \quad T \le t_1,\]</span> where <span class="math inline">\(s_1+t_1 \le N_1\)</span>. The acceptance region of the null can be denoted by <span class="math display">\[ S \le s_1'(&lt;s_1)  \quad or \quad T \ge t_1'(&gt;t_1).\]</span></p>
<p>Stop the trial the second stage if the number of corresponding patients satisfies the rejection or acceptance condition, enroll additional <span class="math inline">\(N_2\)</span> patients and continue to the second stage otherwise. At the second stage, the rejection region of the null hypothesis <span class="math inline">\(H_{U}\)</span> can be denoted by <span class="math display">\[ S \ge s_2 \quad and \quad T \le t_2,\]</span> where <span class="math inline">\(s_2+t_2 \le N_1+N_2\)</span>. We can also consider the acceptance region can be denoted by <span class="math display">\[ S \ge s_2' \quad or \quad T \le t_2',\]</span> althogh the original paper does not mention the acceptance region for futility.</p>
</div>
</div>
<div id="the-power-function-for-multinomial-design-using-iut" class="section level1">
<h1>The power function for multinomial design using IUT</h1>
<div id="one-stage-multinomial-design" class="section level2">
<h2>One-stage multinomial design</h2>
<div id="power-function-validation" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test whole data</span>
s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">23</span>, 
    <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">27</span>, <span class="dv">27</span>, <span class="dv">29</span>, <span class="dv">24</span>)
t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">16</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">7</span>, 
    <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>)
n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">36</span>, <span class="dv">39</span>, <span class="dv">45</span>, <span class="dv">44</span>, <span class="dv">39</span>, <span class="dv">33</span>, <span class="dv">35</span>, <span class="dv">44</span>, <span class="dv">47</span>, <span class="dv">44</span>, <span class="dv">46</span>, <span class="dv">42</span>, <span class="dv">39</span>, <span class="dv">47</span>, <span class="dv">49</span>, <span class="dv">49</span>, <span class="dv">44</span>, 
    <span class="dv">42</span>, <span class="dv">47</span>, <span class="dv">45</span>, <span class="dv">45</span>, <span class="dv">37</span>, <span class="dv">45</span>, <span class="dv">42</span>, <span class="dv">36</span>, <span class="dv">39</span>, <span class="dv">28</span>)
p0.s &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">mapply</span>(rep, <span class="dv">1</span>:<span class="dv">7</span>, <span class="dv">7</span>:<span class="dv">1</span>)) *<span class="st"> </span><span class="fl">0.1</span>
p0.t &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">mapply</span>(seq, <span class="dv">9</span>:<span class="dv">3</span>, <span class="dv">3</span>)) *<span class="st"> </span><span class="fl">0.1</span>
p1.s &lt;-<span class="st"> </span>p0.s +<span class="st"> </span><span class="fl">0.2</span>
p1.t &lt;-<span class="st"> </span>p0.t -<span class="st"> </span><span class="fl">0.2</span>

sig.s1.IUT &lt;-<span class="st"> </span><span class="kw">pmax</span>(<span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> s, <span class="dt">t2.rej =</span> t, 
    <span class="dt">n =</span> n, <span class="dt">p.s =</span> p0.s, <span class="dt">p.t =</span> <span class="dv">0</span>, <span class="dt">USE.NAMES =</span> F), <span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, 
    <span class="dt">s2.rej =</span> s, <span class="dt">t2.rej =</span> t, <span class="dt">n =</span> n, <span class="dt">p.s =</span> <span class="dv">1</span> -<span class="st"> </span>p0.t, <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F))
power.s1.IUT &lt;-<span class="st"> </span><span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> s, <span class="dt">t2.rej =</span> t, <span class="dt">n =</span> n, 
    <span class="dt">p.s =</span> p1.s, <span class="dt">p.t =</span> p1.t, <span class="dt">USE.NAMES =</span> F)
result.s1.IUT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s.rej =</span> s, <span class="dt">t.rej =</span> t, <span class="dt">N =</span> n, <span class="dt">Error =</span> sig.s1.IUT, 
    <span class="dt">Power =</span> power.s1.IUT)
<span class="kw">print</span>(result.s1.IUT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s.rej t.rej  N  Error Power
## 1   0.1  0.9     6    19 25 0.0334 0.807
## 2   0.1  0.8     8    24 36 0.0424 0.804
## 3   0.1  0.7     8    22 39 0.0500 0.807
## 4   0.1  0.6     9    21 45 0.0483 0.833
## 5   0.1  0.5     9    16 44 0.0481 0.827
## 6   0.1  0.4     8    10 39 0.0450 0.814
## 7   0.1  0.3     7     5 33 0.0417 0.818
## 8   0.2  0.8    12    23 35 0.0344 0.805
## 9   0.2  0.7    14    25 44 0.0437 0.824
## 10  0.2  0.6    15    22 47 0.0460 0.818
## 11  0.2  0.5    14    16 44 0.0481 0.802
## 12  0.2  0.4    15    12 46 0.0354 0.801
## 13  0.2  0.3    14     7 42 0.0378 0.814
## 14  0.3  0.7    17    22 39 0.0500 0.832
## 15  0.3  0.6    20    22 47 0.0460 0.821
## 16  0.3  0.5    21    18 49 0.0427 0.811
## 17  0.3  0.4    21    13 49 0.0382 0.815
## 18  0.3  0.3    19     7 44 0.0437 0.810
## 19  0.4  0.6    23    19 42 0.0375 0.803
## 20  0.4  0.5    25    17 47 0.0460 0.808
## 21  0.4  0.4    24    12 45 0.0483 0.809
## 22  0.4  0.3    24     8 45 0.0483 0.840
## 23  0.5  0.5    24    13 37 0.0494 0.807
## 24  0.5  0.4    29    12 45 0.0446 0.808
## 25  0.5  0.3    27     7 42 0.0442 0.813
## 26  0.6  0.4    27     9 36 0.0449 0.832
## 27  0.6  0.3    29     6 39 0.0450 0.823
## 28  0.7  0.3    24     4 28 0.0474 0.858</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level-and-record-the-computing-process-time." class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level, and record the computing process time.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set the intervals as +-1</span>
<span class="kw">IUT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">n.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##    p0.s p0.t p1.s p1.t s.rej t.rej  N Error Power
## 17 0.15 0.25  0.3  0.1    18    13 80 0.048 0.924
##    user  system elapsed 
##    0.47    0.00    0.47</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># defaut do not set the intervals</span>
<span class="kw">IUT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, 
    <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##   p0.s p0.t p1.s p1.t s.rej t.rej  N Error Power
## 1 0.15 0.25  0.3  0.1    18    12 80 0.048 0.899
##    user  system elapsed 
##    0.02    0.00    0.02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># output all valid outcome</span>
<span class="kw">IUT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">n.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>, 
    <span class="dt">output.all =</span> T)</code></pre></div>
<pre><code>##    p0.s p0.t p1.s p1.t s.rej t.rej  N  Error Power
## 2  0.15 0.25  0.3  0.1    18    11 79 0.0430 0.857
## 3  0.15 0.25  0.3  0.1    19    11 79 0.0228 0.825
## 5  0.15 0.25  0.3  0.1    18    12 79 0.0430 0.896
## 6  0.15 0.25  0.3  0.1    19    12 79 0.0254 0.862
## 8  0.15 0.25  0.3  0.1    18    13 79 0.0477 0.919
## 9  0.15 0.25  0.3  0.1    19    13 79 0.0477 0.882
## 11 0.15 0.25  0.3  0.1    18    11 80 0.0480 0.857
## 12 0.15 0.25  0.3  0.1    19    11 80 0.0259 0.829
## 14 0.15 0.25  0.3  0.1    18    12 80 0.0480 0.899
## 15 0.15 0.25  0.3  0.1    19    12 80 0.0259 0.869
## 17 0.15 0.25  0.3  0.1    18    13 80 0.0480 0.924
## 18 0.15 0.25  0.3  0.1    19    13 80 0.0421 0.891
## 21 0.15 0.25  0.3  0.1    19    11 81 0.0292 0.831
## 24 0.15 0.25  0.3  0.1    19    12 81 0.0292 0.874
## 27 0.15 0.25  0.3  0.1    19    13 81 0.0371 0.899
##    user  system elapsed 
##    0.48    0.00    0.48</code></pre>
</div>
</div>
<div id="two-stage-multinomial-design" class="section level2">
<h2>Two-stage multinomial design</h2>
<div id="power-function-validation-1" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Test whole data
s1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">16</span>, 
    <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">14</span>)
s2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">9</span>, 
    <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">10</span>)
t1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, 
    <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>)
t2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">12</span>, 
    <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">4</span>)
a1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">18</span>, <span class="dv">22</span>, 
    <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">24</span>)
a2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">7</span>, 
    <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>)
n1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">20</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">24</span>, 
    <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">19</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">14</span>)
n2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">15</span>, <span class="dv">19</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">24</span>, 
    <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">14</span>)
<span class="co"># show the results of IUT for two-stage with early stop for both superority</span>
<span class="co"># and futility</span>
sig.s2.sf.IUT &lt;-<span class="st"> </span><span class="kw">pmax</span>(<span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> s1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.rej =</span> t1, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p0.s, 
    <span class="dt">p.t =</span> <span class="dv">0</span>, <span class="dt">USE.NAMES =</span> F), <span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> s1, 
    <span class="dt">s1.acc =</span> s2, <span class="dt">t1.rej =</span> t1, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, 
    <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> <span class="dv">1</span> -<span class="st"> </span>p0.t, <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F))
power.s2.sf.IUT &lt;-<span class="st"> </span><span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> s1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.rej =</span> t1, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p1.s, 
    <span class="dt">p.t =</span> p1.t, <span class="dt">USE.NAMES =</span> F)
result.s2.sf.IUT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s1.rej =</span> s1, <span class="dt">t1.rej =</span> t1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">N1 =</span> n1, <span class="dt">N2 =</span> n2, <span class="dt">Error =</span> sig.s2.sf.IUT, 
    <span class="dt">Power =</span> power.s2.sf.IUT)
<span class="kw">print</span>(result.s2.sf.IUT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s1.rej t1.rej s1.acc t1.acc s2.rej t2.rej N1 N2  Error Power
## 1   0.1  0.9      4      9      0     13      6     18 13 11 0.0486 0.800
## 2   0.1  0.8      6      8      0     15      7     22 18 15 0.0497 0.801
## 3   0.1  0.7      6      7      1     15      8     22 20 19 0.0495 0.803
## 4   0.1  0.6      6      6      0     13      9     20 22 21 0.0483 0.800
## 5   0.1  0.5      7      5      2     11      8     15 21 21 0.0494 0.804
## 6   0.1  0.4      6      2      2      9      8     10 20 19 0.0460 0.801
## 7   0.1  0.3      6      0      1      5      7      5 17 16 0.0415 0.810
## 8   0.2  0.8      8      9      1     16     11     21 17 15 0.0448 0.800
## 9   0.2  0.7      9     10      5     16     14     25 22 22 0.0487 0.803
## 10  0.2  0.6     10      7      5     15     14     21 23 22 0.0491 0.802
## 11  0.2  0.5     10      4      3     12     14     16 22 22 0.0482 0.800
## 12  0.2  0.4     10      3      4      8     14     12 23 21 0.0495 0.806
## 13  0.2  0.3     10      1      4      6     12      6 20 17 0.0490 0.801
## 14  0.3  0.7     11      9      4     16     17     21 20 18 0.0466 0.801
## 15  0.3  0.6     13      8      7     14     20     22 24 23 0.0485 0.806
## 16  0.3  0.5     13      6      6     13     20     17 24 23 0.0497 0.801
## 17  0.3  0.4     14      4      8      9     20     13 24 24 0.0500 0.809
## 18  0.3  0.3     12      1      3      8     18      7 21 20 0.0479 0.800
## 19  0.4  0.6     15      6      9     12     22     19 21 20 0.0491 0.812
## 20  0.4  0.5     16      6      9     12     25     17 24 23 0.0477 0.804
## 21  0.4  0.4     16      3      8      9     24     12 23 22 0.0490 0.803
## 22  0.4  0.3     16      2      9      7     23      7 22 21 0.0483 0.800
## 23  0.5  0.5     16      3      9     10     24     13 19 18 0.0492 0.804
## 24  0.5  0.4     17      3      8     11     27     11 21 21 0.0497 0.800
## 25  0.5  0.3     16      1     10      6     27      7 21 21 0.0494 0.809
## 26  0.6  0.4     16      2     10      8     25      8 18 15 0.0473 0.803
## 27  0.6  0.3     17      0     11      5     27      6 19 17 0.0497 0.806
## 28  0.7  0.3     14      0     10      4     24      4 14 14 0.0487 0.852</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level-and-record-the-computing-process-time.-1" class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level, and record the computing process time.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">IUT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> <span class="dv">10</span>, <span class="dt">t1.rej =</span> <span class="dv">3</span>, <span class="dt">s1.acc =</span> <span class="dv">8</span>, <span class="dt">t1.acc =</span> <span class="dv">5</span>, 
    <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n1 =</span> <span class="dv">41</span>, <span class="dt">n2 =</span> <span class="dv">41</span>, <span class="dt">s1.rej.delta =</span> <span class="dv">1</span>, <span class="dt">t1.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, 
    <span class="dt">p1.t =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##    p0.s p0.t p1.s p1.t s1.rej t1.rej s1.acc t1.acc s2.rej t2.rej N1 N2
## 81 0.15 0.25  0.3  0.1     11      4      8      5     19     13 41 41
##     Error Power
## 81 0.0476 0.875
##    user  system elapsed 
##   37.39    0.01   37.44</code></pre>
</div>
</div>
<div id="two-stage-multinomial-design-with-futlity-only" class="section level2">
<h2>Two-stage multinomial design with futlity only</h2>
<div id="power-function-validation-2" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show the results of IUT for two-stage with early stop for only futility</span>
sig.s2.f.IUT &lt;-<span class="st"> </span><span class="kw">pmax</span>(<span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, 
    <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p0.s, <span class="dt">p.t =</span> <span class="dv">0</span>, <span class="dt">USE.NAMES =</span> F), 
    <span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, 
        <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> <span class="dv">1</span> -<span class="st"> </span>p0.t, <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F))

nul &lt;-<span class="st"> </span><span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, 
    <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p0.s, <span class="dt">p.t =</span> p0.t, <span class="dt">output.all =</span> <span class="ot">TRUE</span>, 
    <span class="dt">USE.NAMES =</span> F)


alt &lt;-<span class="st"> </span><span class="kw">mapply</span>(IUT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, 
    <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p1.s, <span class="dt">p.t =</span> p1.t, <span class="dt">output.all =</span> <span class="ot">TRUE</span>, 
    <span class="dt">USE.NAMES =</span> F)


result.s2.f.IUT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, 
    <span class="dt">t2.rej =</span> a2, <span class="dt">N1 =</span> n1, <span class="dt">N2 =</span> n2, <span class="dt">Error =</span> sig.s2.f.IUT, <span class="dt">PET.nul =</span> nul[<span class="dv">2</span>, ], 
    <span class="dt">EN.nul =</span> nul[<span class="dv">3</span>, ], <span class="dt">Power =</span> alt[<span class="dv">1</span>, ], <span class="dt">PET.alt =</span> alt[<span class="dv">2</span>, ], <span class="dt">EN.alt =</span> alt[<span class="dv">3</span>, 
        ])
<span class="kw">print</span>(result.s2.f.IUT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s1.acc t1.acc s2.rej t2.rej N1 N2  Error PET.nul EN.nul Power
## 1   0.1  0.9      0     13      6     18 13 11 0.0276   0.254   21.2 0.770
## 2   0.1  0.8      0     15      7     22 18 15 0.0497   0.521   25.2 0.801
## 3   0.1  0.7      1     15      8     22 20 19 0.0494   0.563   28.3 0.803
## 4   0.1  0.6      0     13      9     20 22 21 0.0479   0.640   29.6 0.800
## 5   0.1  0.5      2     11      8     15 21 21 0.0489   0.770   25.8 0.801
## 6   0.1  0.4      2      9      8     10 20 19 0.0449   0.766   24.4 0.800
## 7   0.1  0.3      1      5      7      5 17 16 0.0407   0.765   20.8 0.810
## 8   0.2  0.8      1     16     11     21 17 15 0.0411   0.118   30.2 0.795
## 9   0.2  0.7      5     16     14     25 22 22 0.0427   0.749   27.5 0.797
## 10  0.2  0.6      5     15     14     21 23 22 0.0480   0.725   29.1 0.801
## 11  0.2  0.5      3     12     14     16 22 22 0.0477   0.535   32.2 0.800
## 12  0.2  0.4      4      8     14     12 23 21 0.0480   0.832   26.5 0.805
## 13  0.2  0.3      4      6     12      6 20 17 0.0487   0.795   23.5 0.801
## 14  0.3  0.7      4     16     17     21 20 18 0.0387   0.238   33.7 0.791
## 15  0.3  0.6      7     14     20     22 24 23 0.0442   0.711   30.6 0.803
## 16  0.3  0.5      6     13     20     17 24 23 0.0454   0.536   34.7 0.797
## 17  0.3  0.4      8      9     20     13 24 24 0.0493   0.836   27.9 0.808
## 18  0.3  0.3      3      8     18      7 21 20 0.0458   0.314   34.7 0.798
## 19  0.4  0.6      9     12     22     19 21 20 0.0483   0.691   27.2 0.811
## 20  0.4  0.5      9     12     25     17 24 23 0.0452   0.640   32.3 0.801
## 21  0.4  0.4      8      9     24     12 23 22 0.0480   0.664   30.4 0.802
## 22  0.4  0.3      9      7     23      7 22 21 0.0479   0.726   27.8 0.799
## 23  0.5  0.5      9     10     24     13 19 18 0.0487   0.500   28.0 0.803
## 24  0.5  0.4      8     11     27     11 21 21 0.0449   0.245   36.9 0.798
## 25  0.5  0.3     10      6     27      7 21 21 0.0435   0.715   27.0 0.806
## 26  0.6  0.4     10      8     25      8 18 15 0.0443   0.437   26.5 0.800
## 27  0.6  0.3     11      5     27      6 19 17 0.0494   0.748   23.3 0.805
## 28  0.7  0.3     10      4     24      4 14 14 0.0459   0.645   19.0 0.850
##    PET.alt EN.alt
## 1  0.00969   23.9
## 2  0.03319   32.5
## 3  0.02570   38.5
## 4  0.05530   41.8
## 5  0.04945   41.0
## 6  0.04372   38.2
## 7  0.04010   32.4
## 8  0.00209   32.0
## 9  0.07689   42.3
## 10 0.05896   43.7
## 11 0.02011   43.6
## 12 0.08480   42.2
## 13 0.06002   36.0
## 14 0.00591   37.9
## 15 0.06555   45.5
## 16 0.02004   46.5
## 17 0.09835   45.6
## 18 0.00134   41.0
## 19 0.08492   39.3
## 20 0.04144   46.0
## 21 0.03575   44.2
## 22 0.05767   41.8
## 23 0.03255   36.4
## 24 0.00298   41.9
## 25 0.03692   41.2
## 26 0.01628   32.8
## 27 0.04888   35.2
## 28 0.04413   27.4</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level-and-record-the-computing-process-time.-2" class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level, and record the computing process time.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">IUT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> <span class="dv">7</span>, <span class="dt">t1.acc =</span> <span class="dv">5</span>, <span class="dt">s2.rej =</span> <span class="dv">17</span>, <span class="dt">t2.rej =</span> <span class="dv">13</span>, 
    <span class="dt">n1 =</span> <span class="dv">41</span>, <span class="dt">n2 =</span> <span class="dv">41</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, 
    <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##   p0.s p0.t p1.s p1.t s1.acc t1.acc s2.rej t2.rej N1 N2  Error Power
## 9 0.15 0.25  0.3  0.1      7      5     18     14 41 41 0.0499 0.576
##    user  system elapsed 
##   16.31    0.00   16.35</code></pre>
</div>
</div>
</div>
<div id="the-power-function-for-uit" class="section level1">
<h1>The power function for UIT</h1>
<div id="one-stage-multinomial-design-1" class="section level2">
<h2>One-stage multinomial design</h2>
<div id="power-function-validation-3" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sig.s1.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> s, <span class="dt">t2.rej =</span> t, <span class="dt">n =</span> n, 
    <span class="dt">p.s =</span> p0.s, <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F)
power.s1.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> s, <span class="dt">t2.rej =</span> t, <span class="dt">n =</span> n, 
    <span class="dt">p.s =</span> p1.s, <span class="dt">p.t =</span> p1.t, <span class="dt">USE.NAMES =</span> F)
result.s1.UIT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s.rej =</span> s, <span class="dt">t.rej =</span> t, <span class="dt">N =</span> n, <span class="dt">Error =</span> sig.s1.UIT, 
    <span class="dt">Power =</span> power.s1.UIT)
<span class="kw">print</span>(result.s1.UIT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s.rej t.rej  N  Error Power
## 1   0.1  0.9     6    19 25 0.0334 0.807
## 2   0.1  0.8     8    24 36 0.0450 0.884
## 3   0.1  0.7     8    22 39 0.0579 0.929
## 4   0.1  0.6     9    21 45 0.0569 0.959
## 5   0.1  0.5     9    16 44 0.0560 0.962
## 6   0.1  0.4     8    10 39 0.0560 0.963
## 7   0.1  0.3     7     5 33 0.0538 0.968
## 8   0.2  0.8    12    23 35 0.0344 0.805
## 9   0.2  0.7    14    25 44 0.0515 0.900
## 10  0.2  0.6    15    22 47 0.0555 0.926
## 11  0.2  0.5    14    16 44 0.0619 0.936
## 12  0.2  0.4    15    12 46 0.0462 0.951
## 13  0.2  0.3    14     7 42 0.0486 0.975
## 14  0.3  0.7    17    22 39 0.0500 0.832
## 15  0.3  0.6    20    22 47 0.0541 0.898
## 16  0.3  0.5    21    18 49 0.0533 0.925
## 17  0.3  0.4    21    13 49 0.0491 0.949
## 18  0.3  0.3    19     7 44 0.0439 0.968
## 19  0.4  0.6    23    19 42 0.0375 0.803
## 20  0.4  0.5    25    17 47 0.0486 0.892
## 21  0.4  0.4    24    12 45 0.0587 0.933
## 22  0.4  0.3    24     8 45 0.0642 0.980
## 23  0.5  0.5    24    13 37 0.0494 0.807
## 24  0.5  0.4    29    12 45 0.0496 0.914
## 25  0.5  0.3    27     7 42 0.0510 0.961
## 26  0.6  0.4    27     9 36 0.0449 0.832
## 27  0.6  0.3    29     6 39 0.0389 0.929
## 28  0.7  0.3    24     4 28 0.0474 0.858</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level-and-record-the-computing-process-time.-3" class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level, and record the computing process time.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set the intervals as +-1</span>
<span class="kw">UIT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">n.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##    p0.s p0.t p1.s p1.t s.rej t.rej  N  Error Power
## 23 0.15 0.25  0.3  0.1    18    12 81 0.0467 0.991
##    user  system elapsed 
##    0.43    0.02    0.45</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># defaut do not set the intervals</span>
<span class="kw">UIT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, 
    <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>, <span class="dt">output.all =</span> T)</code></pre></div>
<pre><code>##   p0.s p0.t p1.s p1.t s.rej t.rej  N  Error Power
## 1 0.15 0.25  0.3  0.1    18    12 80 0.0462  0.99
##    user  system elapsed 
##    0.02    0.00    0.01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># output all valid outcome</span>
<span class="kw">UIT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s1&quot;</span>, <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n =</span> <span class="dv">80</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">n.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>, 
    <span class="dt">output.all =</span> T)</code></pre></div>
<pre><code>##    p0.s p0.t p1.s p1.t s.rej t.rej  N  Error Power
## 2  0.15 0.25  0.3  0.1    18    11 79 0.0342 0.983
## 3  0.15 0.25  0.3  0.1    19    11 79 0.0232 0.976
## 5  0.15 0.25  0.3  0.1    18    12 79 0.0464 0.990
## 6  0.15 0.25  0.3  0.1    19    12 79 0.0358 0.986
## 11 0.15 0.25  0.3  0.1    18    11 80 0.0356 0.984
## 12 0.15 0.25  0.3  0.1    19    11 80 0.0232 0.976
## 14 0.15 0.25  0.3  0.1    18    12 80 0.0462 0.990
## 15 0.15 0.25  0.3  0.1    19    12 80 0.0342 0.986
## 20 0.15 0.25  0.3  0.1    18    11 81 0.0374 0.985
## 21 0.15 0.25  0.3  0.1    19    11 81 0.0237 0.977
## 23 0.15 0.25  0.3  0.1    18    12 81 0.0467 0.991
## 24 0.15 0.25  0.3  0.1    19    12 81 0.0333 0.986
##    user  system elapsed 
##    0.46    0.00    0.47</code></pre>
</div>
</div>
<div id="two-stage-multinomial-design-1" class="section level2">
<h2>Two-stage multinomial design</h2>
<div id="power-function-validation-4" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sig.s2.sf.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> s1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.rej =</span> t1, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p0.s, 
    <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F)
power.s2.sf.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> s1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.rej =</span> t1, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p1.s, 
    <span class="dt">p.t =</span> p1.t, <span class="dt">USE.NAMES =</span> F)
result.s2.sf.UIT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s1.rej =</span> s1, <span class="dt">t1.rej =</span> t1, <span class="dt">s1.acc =</span> s2, 
    <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">N1 =</span> n1, <span class="dt">N2 =</span> n2, <span class="dt">Error =</span> sig.s2.sf.UIT, 
    <span class="dt">Power =</span> power.s2.sf.UIT)
<span class="kw">print</span>(result.s2.sf.UIT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s1.rej t1.rej s1.acc t1.acc s2.rej t2.rej N1 N2  Error Power
## 1   0.1  0.9      4      9      0     13      6     18 13 11 0.0486 0.800
## 2   0.1  0.8      6      8      0     15      7     22 18 15 0.0524 0.719
## 3   0.1  0.7      6      7      1     15      8     22 20 19 0.0476 0.753
## 4   0.1  0.6      6      6      0     13      9     20 22 21 0.0538 0.789
## 5   0.1  0.5      7      5      2     11      8     15 21 21 0.0526 0.853
## 6   0.1  0.4      6      2      2      9      8     10 20 19 0.0354 0.792
## 7   0.1  0.3      6      0      1      5      7      5 17 16 0.0408 0.815
## 8   0.2  0.8      8      9      1     16     11     21 17 15 0.0448 0.800
## 9   0.2  0.7      9     10      5     16     14     25 22 22 0.0437 0.767
## 10  0.2  0.6     10      7      5     15     14     21 23 22 0.0452 0.782
## 11  0.2  0.5     10      4      3     12     14     16 22 22 0.0548 0.815
## 12  0.2  0.4     10      3      4      8     14     12 23 21 0.0563 0.849
## 13  0.2  0.3     10      1      4      6     12      6 20 17 0.0519 0.901
## 14  0.3  0.7     11      9      4     16     17     21 20 18 0.0466 0.801
## 15  0.3  0.6     13      8      7     14     20     22 24 23 0.0488 0.797
## 16  0.3  0.5     13      6      6     13     20     17 24 23 0.0530 0.838
## 17  0.3  0.4     14      4      8      9     20     13 24 24 0.0554 0.889
## 18  0.3  0.3     12      1      3      8     18      7 21 20 0.0600 0.895
## 19  0.4  0.6     15      6      9     12     22     19 21 20 0.0491 0.812
## 20  0.4  0.5     16      6      9     12     25     17 24 23 0.0492 0.839
## 21  0.4  0.4     16      3      8      9     24     12 23 22 0.0554 0.871
## 22  0.4  0.3     16      2      9      7     23      7 22 21 0.0573 0.952
## 23  0.5  0.5     16      3      9     10     24     13 19 18 0.0492 0.804
## 24  0.5  0.4     17      3      8     11     27     11 21 21 0.0554 0.880
## 25  0.5  0.3     16      1     10      6     27      7 21 21 0.0460 0.861
## 26  0.6  0.4     16      2     10      8     25      8 18 15 0.0473 0.803
## 27  0.6  0.3     17      0     11      5     27      6 19 17 0.0519 0.815
## 28  0.7  0.3     14      0     10      4     24      4 14 14 0.0487 0.852</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level." class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UIT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s2.sf&quot;</span>, <span class="dt">s1.rej =</span> <span class="dv">10</span>, <span class="dt">t1.rej =</span> <span class="dv">3</span>, <span class="dt">s1.acc =</span> <span class="dv">8</span>, <span class="dt">t1.acc =</span> <span class="dv">5</span>, 
    <span class="dt">s2.rej =</span> <span class="dv">18</span>, <span class="dt">t2.rej =</span> <span class="dv">12</span>, <span class="dt">n1 =</span> <span class="dv">41</span>, <span class="dt">n2 =</span> <span class="dv">41</span>, <span class="dt">s1.rej.delta =</span> <span class="dv">1</span>, <span class="dt">t1.rej.delta =</span> <span class="dv">1</span>, 
    <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>, <span class="dt">output.all =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##   p0.s p0.t p1.s p1.t s1.rej t1.rej s1.acc t1.acc s2.rej t2.rej N1 N2
## 2 0.15 0.25  0.3  0.1     10      2      8      5     18     12 41 41
## 3 0.15 0.25  0.3  0.1     11      2      8      5     18     12 41 41
## 5 0.15 0.25  0.3  0.1     10      3      8      5     18     12 41 41
## 6 0.15 0.25  0.3  0.1     11      3      8      5     18     12 41 41
## 9 0.15 0.25  0.3  0.1     11      4      8      5     18     12 41 41
##    Error Power
## 2 0.0445 0.853
## 3 0.0310 0.835
## 5 0.0487 0.900
## 6 0.0352 0.887
## 9 0.0461 0.941
##    user  system elapsed 
##    4.26    0.00    4.26</code></pre>
</div>
</div>
<div id="two-stage-multinomial-design-with-futlity-only-1" class="section level2">
<h2>Two-stage multinomial design with futlity only</h2>
<div id="power-function-validation-5" class="section level3">
<h3>Power function validation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sig.s2.f.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, 
    <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p0.s, <span class="dt">p.t =</span> p0.t, <span class="dt">USE.NAMES =</span> F)
power.s2.f.UIT &lt;-<span class="st"> </span><span class="kw">mapply</span>(UIT.power, <span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, 
    <span class="dt">s2.rej =</span> a1, <span class="dt">t2.rej =</span> a2, <span class="dt">n1 =</span> n1, <span class="dt">n2 =</span> n2, <span class="dt">p.s =</span> p1.s, <span class="dt">p.t =</span> p1.t, <span class="dt">USE.NAMES =</span> F)
result.s2.f.UIT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0.s, p0.t, <span class="dt">s1.acc =</span> s2, <span class="dt">t1.acc =</span> t2, <span class="dt">s2.rej =</span> a1, 
    <span class="dt">t2.rej =</span> a2, <span class="dt">N1 =</span> n1, <span class="dt">N2 =</span> n2, <span class="dt">Error =</span> sig.s2.f.UIT, <span class="dt">Power =</span> power.s2.f.UIT)
<span class="kw">print</span>(result.s2.f.UIT, <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>##    p0.s p0.t s1.acc t1.acc s2.rej t2.rej N1 N2  Error Power
## 1   0.1  0.9      0     13      6     18 13 11 0.0273 0.770
## 2   0.1  0.8      0     15      7     22 18 15 0.0561 0.888
## 3   0.1  0.7      1     15      8     22 20 19 0.0575 0.929
## 4   0.1  0.6      0     13      9     20 22 21 0.0564 0.945
## 5   0.1  0.5      2     11      8     15 21 21 0.0603 0.965
## 6   0.1  0.4      2      9      8     10 20 19 0.0557 0.962
## 7   0.1  0.3      1      5      7      5 17 16 0.0533 0.967
## 8   0.2  0.8      1     16     11     21 17 15 0.0411 0.795
## 9   0.2  0.7      5     16     14     25 22 22 0.0501 0.893
## 10  0.2  0.6      5     15     14     21 23 22 0.0622 0.927
## 11  0.2  0.5      3     12     14     16 22 22 0.0617 0.936
## 12  0.2  0.4      4      8     14     12 23 21 0.0672 0.961
## 13  0.2  0.3      4      6     12      6 20 17 0.0624 0.970
## 14  0.3  0.7      4     16     17     21 20 18 0.0387 0.791
## 15  0.3  0.6      7     14     20     22 24 23 0.0524 0.892
## 16  0.3  0.5      6     13     20     17 24 23 0.0532 0.917
## 17  0.3  0.4      8      9     20     13 24 24 0.0619 0.954
## 18  0.3  0.3      3      8     18      7 21 20 0.0609 0.973
## 19  0.4  0.6      9     12     22     19 21 20 0.0483 0.811
## 20  0.4  0.5      9     12     25     17 24 23 0.0480 0.890
## 21  0.4  0.4      8      9     24     12 23 22 0.0581 0.932
## 22  0.4  0.3      9      7     23      7 22 21 0.0506 0.965
## 23  0.5  0.5      9     10     24     13 19 18 0.0487 0.803
## 24  0.5  0.4      8     11     27     11 21 21 0.0519 0.900
## 25  0.5  0.3     10      6     27      7 21 21 0.0503 0.960
## 26  0.6  0.4     10      8     25      8 18 15 0.0443 0.800
## 27  0.6  0.3     11      5     27      6 19 17 0.0573 0.941
## 28  0.7  0.3     10      4     24      4 14 14 0.0459 0.850</code></pre>
</div>
<div id="find-the-rejection-boundary-for-pcr-and-epd-based-on-pre-specified-type-i-error-rate-and-power-level-and-record-the-computing-process-time.-4" class="section level3">
<h3>Find the rejection boundary for pCR and ePD based on pre-specified type I error rate and power level, and record the computing process time.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UIT.design</span>(<span class="dt">method =</span> <span class="st">&quot;s2.f&quot;</span>, <span class="dt">s1.acc =</span> <span class="dv">7</span>, <span class="dt">t1.acc =</span> <span class="dv">5</span>, <span class="dt">s2.rej =</span> <span class="dv">17</span>, <span class="dt">t2.rej =</span> <span class="dv">13</span>, 
    <span class="dt">n1 =</span> <span class="dv">41</span>, <span class="dt">n2 =</span> <span class="dv">41</span>, <span class="dt">s2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">t2.rej.delta =</span> <span class="dv">1</span>, <span class="dt">p0.s =</span> <span class="fl">0.15</span>, <span class="dt">p0.t =</span> <span class="fl">0.25</span>, 
    <span class="dt">p1.s =</span> <span class="fl">0.3</span>, <span class="dt">p1.t =</span> <span class="fl">0.1</span>, <span class="dt">output.all =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##   p0.s p0.t p1.s p1.t s1.acc t1.acc s2.rej t2.rej N1 N2  Error Power
## 3 0.15 0.25  0.3  0.1      7      5     18     12 41 41 0.0368 0.968
## 6 0.15 0.25  0.3  0.1      7      5     18     13 41 41 0.0427 0.971
##    user  system elapsed 
##   24.88    0.00   24.89</code></pre>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
